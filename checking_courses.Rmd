---
title: "finding_courses"
author: "Theo Rose"
date: "2025-02-20"
output: html_document
---

Objectives for this rmd file:

Main: Create a comparable csv file of possibly threatened classes along with their: instructors, number of sections, number of seats, department and overall college.

To get there: 
            *1* Filter data set to only Fall 2024
                ^ This will be our main table to compare again Fall 2025 courses
            *2* Create column tracking vulnerability
              *Thought* May need to make this a scale and not just True or False
            *3* Filter course description for key words that make the course vulnerable
              *3.1* Determine key words list
              *3.2* Add tracker to filtered courses to note them as vulnerable
            *4* Filter titles for key words that increase vulnerability
              *4.1* Determine key words list
              *4.2* Add tracker to filtered titles noting them as vulnerable
            *5* Do the same as 3 and 4 for departments
            *---*
            Eventually: Compare created data set to the Fall 2025 courses,
            checking to see if vulnerable courses stay, seats don't decrease,
            section numbers don't fall and instructors don't change.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*1* Loading in needed libraries

```{r - Libraries / other options}
# Turn off scientific notation
options(scipen=999)

# Libraries
library(tidyverse)

```

*2* Loading in the courses data set from 2024

```{r - Loading data}

# loading UMD courses data
  # ensure the working directory is set to umd_courses

umd_courses <- read_csv("data/courses(1).csv")

```

*3* Looking over the data. 

```{r - understanding the data}

glimpse(umd_courses)

# cols:
  # id, title, description, term, department, level, sections, instructors, seats, open_seats, filled_seats, syllabus_count

```

*4* Dates.

Data set contains Fall 2024, Winter 2024, Spring 2025 and Summer 2025 classes. Added a new column term_cleaned mutating the previously dbl term column to a date column. This will just make future sorting/filtering easier.

```{r Terms}

#Looking at what terms are in the data set
umd_courses |>
  group_by(term) |>
  summarise(
    count = n()
  )

#Making a new column for terms in date format
umd_courses <- umd_courses |>
  mutate(
    term_cleaned = ym(term)
  )

#Reviewing the terms based on the new column
umd_courses |>
  group_by(term_cleaned) |>
  summarise(
    count = n()
  ) |>
  arrange(desc(term_cleaned))

```


*5* Creating new vulnerability column

```{r}

umd_courses[, 'vulnerability'] <- NA #setting all to NA

```


*6* Filtering to only Fall 2024 and making certain cols lower case

```{r}

fall_2024_umd_courses <- umd_courses |>
  filter(
    term_cleaned == "2024-08-01" #Fall 2024 term
  ) |>
  mutate(
    title_lower = str_to_lower(title),
    description_lower = str_to_lower(description),
    department_lower = str_to_lower(department),
    instructors_lower = str_to_lower(instructors)
  )

```


*7* Parameters to detect.

This is where we will set the parameters for what constitutes a vulnerable course. It will just be a list of possible key words to search for.

  *description*
  race, gender, sexuality, disability, equity, environmental justice, research, diversity, inclusion, minority, first generation, underrepresented, diverse, belonging?, diversity/climate, discrimination, non-discrimination, lgbtq+, lgbtq, lesbian, gay, trans, transgender, heterosexual, homosexual, sexuality 
  
  *title*
  Same as description list.

*8* Detecting key words.

This is where we will detect key words to identify a course as vulnerable.

```{r - detecting}

#high vulnerability

fall_2024_umd_courses |>
  filter(
    
    str_detect(description_lower, "diversity") |
    str_detect(description_lower, "equity") |
    str_detect(description_lower, "inclusion") |
    str_detect(description_lower, "dei") |
    str_detect(description_lower, "social justice") |
    str_detect(description_lower, "anti-racism") |
    str_detect(title_lower, "white privilege") |
    str_detect(title_lower, "diversity ") |
    str_detect(title_lower, "equity ") |
    str_detect(title_lower, "inclusion ") |
    str_detect(title_lower, "dei ") |
    str_detect(title_lower, "social justice ") |
    str_detect(title_lower, "anti-racism ") |
    str_detect(title_lower, "white privilege ")
    
    
  ) |>
  select(
    title_lower, department_lower, description_lower
  )

```

*9* Noting the selected courses as vulnerable in the new vulnerability column.

```{r}



```

